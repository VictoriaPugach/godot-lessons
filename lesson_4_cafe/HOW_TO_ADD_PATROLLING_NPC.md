# Как добавить патрулирующую женщину (NPC ходит по магазину)

## Шаг 1: Добавление узла в сцену

1. **В Godot редакторе:**
   - Откройте сцену `cafe.tscn`
   - В корневой узел **Cafe** добавьте новый узел: **Right Click → Add Child Node → Node3D**
   - Назовите его **"PatrollingWoman"** (или любое другое имя, например "Woman", "Customer")

2. **Установите начальную позицию:**
   - Выберите **PatrollingWoman**
   - В Inspector установите **Transform → Position** туда, где должна начинать ходить женщина
   - Например: X=0, Y=0, Z=0 (или любое другое место в кафе)

## Шаг 2: Добавление модели

1. Выберите узел **PatrollingWoman**
2. **Right Click → Add Child Node → Instance Child Scene**
3. Выберите вашу модель с анимацией ходьбы (например, `basic walk.glb` или другой GLB/FBX файл)
4. Модель появится как дочерний узел

5. **Настройте размер модели:**
   - Выберите инстанс модели (дочерний узел с GLB)
   - В Inspector найдите **Transform → Scale**
   - Если модель слишком большая, уменьшите (например, 0.1, 0.1, 0.1)
   - Если слишком маленькая, увеличьте (например, 2.0, 2.0, 2.0)

## Шаг 3: Добавление скрипта

1. Выберите узел **PatrollingWoman**
2. **Right Click → Attach Script**
3. В пути укажите: `res://PatrollingNPC.gd`
4. Нажмите **Create**

## Шаг 4: Настройка анимации ходьбы

### Сначала проверьте какая анимация есть в модели:

1. В FileSystem найдите ваш GLB файл (например, `basic walk.glb`)
2. Дважды кликните на него
3. Godot откроет структуру модели
4. Найдите **AnimationPlayer** в структуре
5. Посмотрите какие анимации есть (они будут в списке справа)
6. Найдите имя анимации ходьбы (например, "Walking", "Walk", "basic walk")

### Затем настройте в скрипте:

1. Выберите узел **PatrollingWoman** в сцене
2. В Inspector найдите параметры скрипта:
   - **Walk Animation**: установите имя анимации ходьбы
     - Например: "Walking" (если в модели так называется)
     - Или: "Walk"
     - Или: "basic walk"
     - Важно: имя должно точно совпадать с именем в модели!

## Шаг 5: Настройка параметров патрулирования

В Inspector на узле **PatrollingWoman** найдите параметры скрипта:

- **Patrol Distance**: расстояние патрулирования (по умолчанию 5.0 метра)
  - Насколько далеко NPC будет ходить вперед-назад
  - Например: 5.0 = 5 метров вперед, потом 5 метров назад
  
- **Patrol Speed**: скорость движения (по умолчанию 1.5 м/с)
  - Увеличьте для более быстрого движения (например, 2.0)
  - Уменьшите для медленного движения (например, 1.0)

## Как это работает:

✅ NPC автоматически начнет патрулировать при запуске игры  
✅ Ходит взад-вперед от начальной позиции по оси Z  
✅ Проигрывает анимацию ходьбы во время движения  
✅ Поворачивается в направлении движения  
✅ Делает небольшую паузу в конце пути перед разворотом

## Направление движения:

- По умолчанию движение по оси Z (вперед-назад)
- Если нужно изменить направление:
  - Поверните узел **PatrollingWoman** по оси Y
  - Или измените Patrol Distance на отрицательное значение

## Проверка:

1. Запустите игру (F5)
2. Женщина должна начать медленно ходить взад-вперед
3. Анимация ходьбы должна проигрываться автоматически

## Возможные проблемы:

**NPC не ходит:**
- ✅ Проверьте что скрипт прикреплен (PatrollingNPC.gd)
- ✅ Проверьте что Patrol Distance больше 0
- ✅ Проверьте что Patrol Speed больше 0

**Анимация не проигрывается:**
- ✅ Проверьте что модель имеет AnimationPlayer (дважды кликните на GLB файл)
- ✅ Проверьте имя анимации в параметре **Walk Animation** - должно точно совпадать с именем в модели
- ✅ Откройте модель двойным кликом и проверьте какие анимации доступны
- ✅ Попробуйте разные имена: "Walking", "Walk", "basic walk", "Running"

**NPC ходит не в ту сторону:**
- Поверните узел PatrollingWoman по оси Y (Transform → Rotation → Y)
- Или измените Patrol Distance на отрицательное значение (например, -5.0)

**Модель не видна или неправильного размера:**
- Проверьте Scale у инстанса модели
- Проверьте Position у инстанса модели
- Убедитесь что модель не находится под полом (проверьте Y координату)

## Пример структуры в сцене:

```
Cafe (Node3D)
├── Player
├── Cashier
├── Food
└── PatrollingWoman (Node3D) ← ваш новый узел
    └── basic walk.glb (Instance) ← ваша модель
        └── (внутри есть AnimationPlayer с анимацией "Walking")
```

## Итоговая проверка:

1. ✅ Узел PatrollingWoman создан
2. ✅ Модель добавлена через Instance Child Scene
3. ✅ Скрипт PatrollingNPC.gd прикреплен
4. ✅ Walk Animation установлено правильное имя
5. ✅ Patrol Distance и Patrol Speed настроены
6. ✅ Запущена игра - NPC ходит!
