# Как использовать анимированную модель для кассира и настроить патрулирование

## Шаг 1: Подготовка модели

1. Убедитесь что у вас есть GLB файл с анимациями кассира (например, `cashier.glb` или `Кассир.glb`)
2. Импортируйте его в Godot (просто перетащите в папку проекта)

## Шаг 2: Просмотр структуры модели

1. Дважды кликните на файл модели в Godot
2. Godot откроет структуру модели
3. Проверьте наличие **AnimationPlayer** в структуре - это означает что у модели есть анимации
4. Посмотрите какие анимации есть (например, "Idle", "Wave", "Talk")

## Шаг 3: Замена модели в сцене

### Вариант А: Использовать модель как Instance Child Scene (рекомендуется)

1. Откройте сцену `cafe.tscn`
2. Найдите узел **Cashier**
3. Выберите дочерний узел **MeshInstance3D** (с BoxMesh)
4. **Удалите его** (Delete или Right Click → Delete Nodes)
5. **Right Click на Cashier → Add Child Node → Instance Child Scene**
6. Выберите ваш GLB файл с кассиром (например, `cashier.glb`)
7. Модель появится как дочерний узел

### Вариант Б: Заменить Mesh напрямую

1. Выберите **Cashier → MeshInstance3D**
2. В Inspector → **Mesh → Load**
3. Выберите ваш GLB файл
4. **ВНИМАНИЕ**: Этот способ не сохранит анимации! Используйте Вариант А для анимированных моделей.

## Шаг 4: Настройка позиции и масштаба

1. Выберите инстанс модели кассира
2. Настройте **Transform → Position** чтобы модель стояла на нужном месте
3. Настройте **Transform → Scale** если модель слишком большая/маленькая (например, 0.5, 0.5, 0.5)

## Шаг 5: Управление анимациями и патрулированием через скрипт

Скрипт `Cashier.gd` уже обновлен для работы с анимациями и патрулированием. Он автоматически:
- Найдет AnimationPlayer в модели
- Воспроизведет анимацию "Walk" во время патрулирования (ходьбы)
- Воспроизведет анимацию "Wave" когда игрок подходит
- Воспроизведет анимацию "Talk" когда игрок разговаривает
- Остановится и повернется к игроку когда он рядом
- Возобновит патрулирование когда игрок уходит

Если ваша модель использует другие имена анимаций, выберите **Cashier** в сцене и в Inspector измените:
- `idle_animation` (по умолчанию "Idle") - анимация покоя
- `walk_animation` (по умолчанию "Walk") - анимация ходьбы
- `wave_animation` (по умолчанию "Wave") - анимация приветствия
- `talk_animation` (по умолчанию "Talk") - анимация разговора

## Настройка патрулирования

Скрипт кассира поддерживает автоматическое патрулирование (медленное хождение взад-вперед):

1. Выберите узел **Cashier** в сцене
2. В Inspector найдите параметры скрипта:
   - **Patrol Enabled**: включить/выключить патрулирование (по умолчанию включено)
   - **Patrol Distance**: расстояние патрулирования в метрах (по умолчанию 3.0)
   - **Patrol Speed**: скорость движения в метрах в секунду (по умолчанию 1.0)

3. Кассир автоматически:
   - Двигается вперед-назад от начальной позиции
   - Проигрывает анимацию ходьбы во время движения
   - Останавливается и поворачивается к игроку когда он рядом
   - Возобновляет патрулирование когда игрок уходит

## Проверка анимаций и патрулирования

1. Запустите игру
2. Кассир должен начать медленно ходить взад-вперед
3. Подойдите к кассиру - он остановится и должна проигрываться анимация приветствия
4. Нажмите E для разговора - должна проигрываться анимация разговора
5. Отойдите от кассира - он возобновит патрулирование

## Возможные проблемы

**Модель не появляется:**
- Проверьте масштаб (возможно модель слишком маленькая/большая)
- Проверьте позицию модели

**Анимации не работают:**
- Убедитесь что используете Instance Child Scene (Вариант А), а не просто замену Mesh
- Проверьте что в модели есть AnimationPlayer
- Откройте модель двойным кликом и проверьте какие анимации доступны

**Модель находится не там где нужно:**
- Настройте Transform → Position инстанса модели
- Возможно нужно настроить позицию корневого узла модели

